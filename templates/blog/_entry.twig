{% extends "_layout" %}

{% set image = entry.blogImage.one() %}

{% block openGraph %}
    <meta name="description" content="{{ entry.summary }}">
    <meta property="og:description" content="{{ entry.summary }}">
    {% if image %}
        <meta property="og:image" content="{{ image.getUrl({ format: 'jpg', height: 630, width: 1200 }) }}">
        <meta property="og:image:height" content="630">
        <meta property="og:image:width" content="1200">
        <meta property="og:image:type" content="image/jpeg">
    {% endif %}
    <meta property="og:locale" content="{{ currentSite.language|replace({'-': '_'}) }}">
    <meta property="og:site_name" content="{{ siteName }}">
    <meta property="og:title" content="{{ entry.title }}">
    <meta property="og:type" content="article">
    <meta property="og:url" content="{{ entry.url }}">
{% endblock %}

{% block schema %}
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "BlogPosting",
            "author": {
                "@type": "Person",
                "name": "{{ entry.author.fullName }}"
            },
            "datePublished": "{{ entry.postDate|date('Y-m-d') }}",
            "headline": "{{ entry.title }}",
            "image": {
                "@type": "ImageObject",
                "url": "{{ image.getUrl({ format: 'webp', height: 630, width: 1200 }) }}"
            }
        }
    </script>
{% endblock %}

{% block content %}
    <article class="blog">
        <header class="blog__header js-equinox">
            <div class="wrapper">
                <div class="grid grid--end grid--gap-l l:grid--reverse">
                    <div class="grid__col l:grid__col--span-8">
                        <picture class="blog__header-picture">
                            <source
                                sizes="(max-width: 1024px) 100vw, 50vw"
                                srcset="
                                    {{ image.getUrl({ width: 480, format: 'webp' }) }} 480w,
                                    {{ image.getUrl({ width: 592, format: 'webp' }) }} 592w,
                                    {{ image.getUrl({ width: 768, format: 'webp' }) }} 768w,
                                    {{ image.getUrl({ width: 1024, format: 'webp' }) }} 1024w,
                                    {{ image.getUrl({ width: 1184, format: 'webp' }) }} 1184w,
                                    {{ image.getUrl({ width: 1536, format: 'webp' }) }} 1536w,
                                    {{ image.getUrl({ width: 2048, format: 'webp' }) }} 2048w
                                "
                                type="image/webp"
                            />
                            <img
                                alt="{{ entry.title }}"
                                decoding="async"
                                loading="lazy"
                                sizes="(max-width: 1024px) 100vw, 50vw"
                                src="{{ image.getUrl({ width: 768 }) }}"
                                srcset="
                                    {{ image.getUrl({ width: 480 }) }} 480w,
                                    {{ image.getUrl({ width: 592 }) }} 592w,
                                    {{ image.getUrl({ width: 768 }) }} 768w,
                                    {{ image.getUrl({ width: 1024 }) }} 1024w,
                                    {{ image.getUrl({ width: 1184 }) }} 1184w,
                                    {{ image.getUrl({ width: 1536 }) }} 1536w,
                                    {{ image.getUrl({ width: 2048 }) }} 2048w
                                "
                            >
                        </picture>
                    </div>
                    <div class="grid__col l:grid__col--span-4">
                        <div class="blog__header-content">
                            <div class="stack stack--gap-m">
                                <h5><a class="blog__header-back" href="/blog"><i data-lucide="chevron-left"></i> Blog</a></h5>
                                <h1 class="blog__title textSplit js-textSplit">{{ entry.title }}</h1>
                            </div>
                            <div class="blog__header-meta">
                                <ul class="meta">
                                    {% if entry.author.photo is not empty %}
                                        <li>
                                            <div class="blog__author">
                                                <img alt="" class="blog__author-image" src="{{ entry.author.photo.getUrl({ format: 'webp', height: 64, width: 64 }) }}">
                                                {{ entry.author.fullName }}
                                            </div>
                                        </li>
                                    {% endif %}
                                    <li><time datetime="{{ entry.postDate|date('Y-m-d') }}">{{ entry.postDate|date('j F Y') }}</time></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <section class="section">
            <div class="section__inner wrapper">
                <div class="grid grid--gap-xxl">
                    <div class="grid__col l:grid__col--span-8">
                        <div class="blog__body">
                            {% for block in entry.body.all() %}
                                {% include "_body/" ~ block.type with { block: block } %}
                            {% endfor %}
                        </div>
                    </div>
                    <div class="grid__col l:grid__col--span-4">
                        <section class="blogList">
                            <h3 class="blogList__title">Lees ook</h3>
                            <ol class="blogList__list">
                                {% for blog in craft.entries.section('blogs').all() %}
                                    {% if blog.slug != entry.slug %}
                                        {% set image = blog.blogImage.one() %}
                                        <li class="blogListItem">
                                            {% if image %}
                                                <a class="blogListItem__imageLink" href="{{ blog.url }}">
                                                    <img
                                                        alt="{{ blog.title }}"
                                                        class="blogListItem__image"
                                                        src="{{ blog.blogImage.one().getUrl({ format: 'webp', height: 180, width: 180 }) }}"
                                                    >
                                                </a>
                                            {% endif %}
                                            <div class="blogListItem__text">
                                                <h4 class="blogListItem__title"><a href="{{ blog.url }}">{{ blog.title }}</a></h4>
                                                <time class="blogListItem__date" datetime="{{ blog.postDate|date('Y-m-d H:i:s') }}">{{ blog.postDate|date('j F Y') }}</time>
                                            </div>
                                        </li>
                                    {% endif %}
                                {% endfor %}
                            </ol>
                        </section>
                    </div>
                </div>
            </div>
        </section>
    </article>
{% endblock %}